{"version":3,"sources":["../../../src/utils/lcboParser.js"],"names":["lcboParser","html","params","responseHandler","dataAggregationType","tel","entry","inv","phone","length","default","region","inventory","address","slice","join","obj","push","addressnomailing","callback","ch","load","$","bind","format","hasOwnProperty","returntype","lcboTable","find","each","i","elem","whatIfound","text","replace","match","parseInt"],"mappings":"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","file":"lcboParser.js","sourcesContent":["import cheerio from 'cheerio';\n\nclass lcboParser{\n    constructor(html, params, responseHandler){\n        const dataAggregationType = {\n            tel: function (entry, inv) {\n                if (!inv){\n                    inv = {};\n                }\n                let phone = entry[entry.length-2];\n                inv[phone] = entry[entry.length - 1];\n                return inv;\n            },\n            default: function (entry, inv) {\n                if (!inv){\n                    inv = [];\n                }\n                let region = entry[0];\n                let inventory = entry[entry.length-1];\n                let phone = entry[entry.length-2];\n                let address = entry.slice(1, entry.length-2).join(\", \");\n                let obj = {\n                    \"region\": region,\n                    \"inventory\": inventory,\n                    \"address\": address,\n                    \"phone\": phone\n                };\n                inv.push(obj);\n                return inv;\n            },\n            address: function (entry, inv) {\n                if (!inv){\n                    inv = {};\n                }\n                let address = entry.slice(1, entry.length-2).join(\", \");\n                inv[address] = entry[entry.length - 1];\n                return inv;\n            },\n            addressnomailing: function (entry, inv) {\n                if (!inv){\n                    inv = {};\n                }\n                let address = entry[1];\n                inv[address] = entry[entry.length - 1];\n                return inv;\n            }\n        };\n\n        this.callback = responseHandler;\n        const ch = cheerio.load(html);\n        this.$ = ch.bind(this);\n        this.format = function(){\n            if (!params.hasOwnProperty('returntype')){\n                return dataAggregationType.default.bind(this);\n            } else if (dataAggregationType.hasOwnProperty(params.returntype)){\n                return dataAggregationType[params.returntype].bind(this);\n            } else {\n                responseHandler(\"Invalid Parameters for Return Type\");\n            }\n        }();\n    }\n\n    parseInventory(){\n        let lcboTable = this.$('#storeInventory');\n        let inv = null;\n        lcboTable.find('tbody').find('tr').each((i,elem) => {\n            let entry = [];\n            this.$(elem).find('p').each((i, elem) => {\n                let whatIfound = this.$(elem).text();\n                whatIfound = whatIfound.replace(/[^\\w][^\\w][^\\w]+/g, '');\n                if (whatIfound.match(/^[0-9]+$/)){\n                    entry.push(parseInt(whatIfound));\n                } else {\n                    entry.push(whatIfound);\n                }\n            });\n            inv = this.format(entry, inv);\n        });\n        this.callback(inv);\n    }\n}\n\nexport default lcboParser;"]}